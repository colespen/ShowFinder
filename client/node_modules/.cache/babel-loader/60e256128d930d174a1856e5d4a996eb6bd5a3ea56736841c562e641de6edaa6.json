{"ast":null,"code":"var _jsxFileName = \"/Users/macbookpro/Documents/Dev/ShowFinder/src/components/Map.jsx\",\n  _s2 = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { MapContainer, TileLayer, useMap, Marker, Popup } from 'react-leaflet';\nimport L from \"leaflet\";\nimport useGeoLocation from '../hooks/useGeoLocation';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Map(props) {\n  _s2();\n  var _s = $RefreshSig$();\n  const [shows, setShows] = useState({});\n  const [currCity, setCurrCity] = useState({});\n  const geolocation = useGeoLocation();\n  console.log(\"geolocation ~~~~~~~~~~~~; \", geolocation);\n  const auth = 'MIUlzyESU3Uvf_ZUQxzFzM0C3vae40bPOYJSMPsN';\n  const current = new Date();\n  const date = `${current.getFullYear()}-${current.getMonth() + 1}-${current.getDate()}`;\n  const lat = geolocation.coords.lat;\n  const lng = geolocation.coords.lng;\n\n  // const hqURL = `https://api.predicthq.com/v1/events/?relevance=rank,start_around,location_around&start_around.origin=2022-12-12&location_around.origin=${geolocation.coords.lat},${geolocation.coords.lng}&location_around.offset=1km&location_around.scale=10km&within=50km@${geolocation.coords.lat},${geolocation.coords.lng}&active.gte=2022-12-12&category=concerts&Authorization=MIUlzyESU3Uvf_ZUQxzFzM0C3vae40bPOYJSMPsN`;\n\n  // useEffect(() => {\n  //   if (geolocation.loaded) axios.get(hqURL, {\n  //     headers: {\n  //       authorization: `Bearer ${auth}`\n  //     }\n  //   })\n  //     .then(res => {\n  //       setShows(res.data);\n  //       console.log(\"res.data~~~~~~~~~: \", res.data);\n  //     })\n  //     .catch(err => {\n  //       console.error(err.message);\n  //     });\n  // }, [geolocation, hqURL]);\n\n  const nyc = [40.7492045258231, -73.98581460369992];\n  function CurrentLocation() {\n    _s();\n    const map = useMap();\n    useEffect(() => {\n      if (geolocation.loaded) map.flyTo(geolocation.coords, 12);\n      // map.setView(geolocation.coords, map.getZoom());\n      const radius = geolocation.accuracy;\n      const circle = L.circle(geolocation.coords, radius);\n      circle.addTo(map);\n    }, [map]);\n    return null;\n  }\n  _s(CurrentLocation, \"IoceErwr5KVGS9kN4RQ1bOkYMAg=\", false, function () {\n    return [useMap];\n  });\n  useEffect(() => {\n    const xhr = new XMLHttpRequest();\n    const token = 'pk.32218541d692e0df20b0912ebadf68bf';\n    xhr.open('GET', `https://us1.locationiq.com/v1/reverse.php?key=${token}&lat=` + lat + \"&lon=\" + lng + \"&format=json\", true);\n    xhr.send();\n    xhr.onreadystatechange = processRequest;\n    xhr.addEventListener(\"readystatechange\", processRequest, false);\n    function processRequest(e) {\n      if (xhr.readyState == 4 && xhr.status == 200) {\n        const response = JSON.parse(xhr.responseText);\n        const city = response.address.city;\n        setCurrCity(city);\n      }\n    }\n  }, [lat, lng]);\n  useEffect(() => {\n    const options = {\n      method: 'GET',\n      baseURL: 'https://api.predicthq.com/v1/events/',\n      params: {\n        'relevance': 'rank,start_around,location_around',\n        'start_around.origin': date,\n        'location_around.origin': lat + \",\" + lng,\n        'location_around.offset': '5km',\n        'location_around.scale': '10km',\n        'active.gte': date,\n        'category': 'concerts'\n      },\n      headers: {\n        authorization: `Bearer ${auth}`\n      }\n    };\n    if (geolocation.loaded) axios.request(options).then(res => {\n      setShows(res.data);\n      console.log(\"res.data~~~~~~~~~: \", res.data);\n    }).catch(err => {\n      console.error(err.message);\n    });\n  }, [geolocation, date, lat, lng]);\n\n  // results OR empty array seems wrong but need to not map on undefined axios get\n  const showMarkers = (shows.results || []).map(show => show.entities.map(venue => /*#__PURE__*/_jsxDEV(Marker, {\n    position: [show.location[1], show.location[0]],\n    children: /*#__PURE__*/_jsxDEV(Popup, {\n      children: [show.title, \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 24\n      }, this), \" \", venue.name]\n    }, venue.entity_id, true, {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 9\n    }, this)\n  }, show.id, false, {\n    fileName: _jsxFileName,\n    lineNumber: 110,\n    columnNumber: 7\n  }, this)));\n  console.log(\"shows~~~~~~~~~: \", shows);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: [\" \", geolocation.loaded ? \"Shows in \" + currCity : \"grabbing your location...\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(MapContainer, {\n      center: nyc,\n      zoom: 8,\n      scrollWheelZoom: true,\n      children: [showMarkers, /*#__PURE__*/_jsxDEV(TileLayer, {\n        attribution: \"\\xA9 <a href=\\\"https://www.openstreetmap.org/copyright\\\">OpenStreetMap</a> contributors\",\n        url: \"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CurrentLocation, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 123,\n    columnNumber: 5\n  }, this);\n}\n_s2(Map, \"vOSP7PqScrtZbNvwlR0Mj9VydFo=\", false, function () {\n  return [useGeoLocation];\n});\n_c = Map;\nvar _c;\n$RefreshReg$(_c, \"Map\");","map":{"version":3,"names":["useState","useEffect","axios","MapContainer","TileLayer","useMap","Marker","Popup","L","useGeoLocation","Map","props","shows","setShows","currCity","setCurrCity","geolocation","console","log","auth","current","Date","date","getFullYear","getMonth","getDate","lat","coords","lng","nyc","CurrentLocation","map","loaded","flyTo","radius","accuracy","circle","addTo","xhr","XMLHttpRequest","token","open","send","onreadystatechange","processRequest","addEventListener","e","readyState","status","response","JSON","parse","responseText","city","address","options","method","baseURL","params","headers","authorization","request","then","res","data","catch","err","error","message","showMarkers","results","show","entities","venue","location","title","name","entity_id","id"],"sources":["/Users/macbookpro/Documents/Dev/ShowFinder/src/components/Map.jsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { MapContainer, TileLayer, useMap, Marker, Popup } from 'react-leaflet';\nimport L from \"leaflet\";\nimport useGeoLocation from '../hooks/useGeoLocation';\n\n\nexport default function Map(props) {\n  const [shows, setShows] = useState({});\n  const [currCity, setCurrCity] = useState({});\n  const geolocation = useGeoLocation();\n  console.log(\"geolocation ~~~~~~~~~~~~; \", geolocation);\n\n  const auth = 'MIUlzyESU3Uvf_ZUQxzFzM0C3vae40bPOYJSMPsN';\n\n  const current = new Date();\n  const date = `${current.getFullYear()}-${current.getMonth() + 1}-${current.getDate()}`;\n\n  const lat = geolocation.coords.lat;\n  const lng = geolocation.coords.lng;\n\n  // const hqURL = `https://api.predicthq.com/v1/events/?relevance=rank,start_around,location_around&start_around.origin=2022-12-12&location_around.origin=${geolocation.coords.lat},${geolocation.coords.lng}&location_around.offset=1km&location_around.scale=10km&within=50km@${geolocation.coords.lat},${geolocation.coords.lng}&active.gte=2022-12-12&category=concerts&Authorization=MIUlzyESU3Uvf_ZUQxzFzM0C3vae40bPOYJSMPsN`;\n\n  // useEffect(() => {\n  //   if (geolocation.loaded) axios.get(hqURL, {\n  //     headers: {\n  //       authorization: `Bearer ${auth}`\n  //     }\n  //   })\n  //     .then(res => {\n  //       setShows(res.data);\n  //       console.log(\"res.data~~~~~~~~~: \", res.data);\n  //     })\n  //     .catch(err => {\n  //       console.error(err.message);\n  //     });\n  // }, [geolocation, hqURL]);\n\n  const nyc =\n    [40.7492045258231, -73.98581460369992];\n\n\n  function CurrentLocation() {\n    const map = useMap();\n\n    useEffect(() => {\n      if (geolocation.loaded) map.flyTo(geolocation.coords, 12);\n      // map.setView(geolocation.coords, map.getZoom());\n      const radius = geolocation.accuracy;\n      const circle = L.circle(geolocation.coords, radius);\n      circle.addTo(map);\n\n    }, [map]);\n    return null;\n  }\n\n  useEffect(() => {\n    const xhr = new XMLHttpRequest();\n\n    const token = 'pk.32218541d692e0df20b0912ebadf68bf';\n    xhr.open('GET',\n      `https://us1.locationiq.com/v1/reverse.php?key=${token}&lat=`\n      + lat + \"&lon=\" + lng + \"&format=json\", true);\n    xhr.send();\n    xhr.onreadystatechange = processRequest;\n    xhr.addEventListener(\"readystatechange\", processRequest, false);\n\n    function processRequest(e) {\n      if (xhr.readyState == 4 && xhr.status == 200) {\n        const response = JSON.parse(xhr.responseText);\n        const city = response.address.city;\n        setCurrCity(city);\n      }\n    }\n  }, [lat, lng]);\n\n\n  useEffect(() => {\n    const options = {\n      method: 'GET',\n      baseURL: 'https://api.predicthq.com/v1/events/',\n      params: {\n        'relevance': 'rank,start_around,location_around',\n        'start_around.origin': date,\n        'location_around.origin': lat + \",\" + lng,\n        'location_around.offset': '5km',\n        'location_around.scale': '10km',\n        'active.gte': date,\n        'category': 'concerts'\n      },\n      headers: {\n        authorization: `Bearer ${auth}`\n      }\n    };\n    if (geolocation.loaded) axios.request(options)\n      .then(res => {\n        setShows(res.data);\n        console.log(\"res.data~~~~~~~~~: \", res.data);\n      })\n      .catch(err => {\n        console.error(err.message);\n      });\n  }, [geolocation, date, lat, lng]);\n\n\n  // results OR empty array seems wrong but need to not map on undefined axios get\n  const showMarkers = (shows.results || []).map(show => (\n    show.entities.map(venue => (\n\n      <Marker\n        key={show.id}\n        position={[show.location[1], show.location[0]]}>\n        <Popup key={venue.entity_id}>\n          {show.title} <br /> {venue.name}\n        </Popup>\n      </Marker>\n    ))\n  ));\n\n  console.log(\"shows~~~~~~~~~: \", shows);\n\n  return (\n    <div>\n      <h1> {geolocation.loaded ? \"Shows in \" +\n        currCity : \"grabbing your location...\"}\n      </h1>\n\n      <MapContainer\n        center={nyc}\n        zoom={8} scrollWheelZoom={true}\n      >\n        {showMarkers}\n\n        <TileLayer\n          attribution=\n          '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        />\n        <CurrentLocation />\n      </MapContainer>\n    </div>\n  );\n}"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,YAAY,EAAEC,SAAS,EAAEC,MAAM,EAAEC,MAAM,EAAEC,KAAK,QAAQ,eAAe;AAC9E,OAAOC,CAAC,MAAM,SAAS;AACvB,OAAOC,cAAc,MAAM,yBAAyB;AAAC;AAGrD,eAAe,SAASC,GAAG,CAACC,KAAK,EAAE;EAAA;EAAA;EACjC,MAAM,CAACC,KAAK,EAAEC,QAAQ,CAAC,GAAGb,QAAQ,CAAC,CAAC,CAAC,CAAC;EACtC,MAAM,CAACc,QAAQ,EAAEC,WAAW,CAAC,GAAGf,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC5C,MAAMgB,WAAW,GAAGP,cAAc,EAAE;EACpCQ,OAAO,CAACC,GAAG,CAAC,4BAA4B,EAAEF,WAAW,CAAC;EAEtD,MAAMG,IAAI,GAAG,0CAA0C;EAEvD,MAAMC,OAAO,GAAG,IAAIC,IAAI,EAAE;EAC1B,MAAMC,IAAI,GAAI,GAAEF,OAAO,CAACG,WAAW,EAAG,IAAGH,OAAO,CAACI,QAAQ,EAAE,GAAG,CAAE,IAAGJ,OAAO,CAACK,OAAO,EAAG,EAAC;EAEtF,MAAMC,GAAG,GAAGV,WAAW,CAACW,MAAM,CAACD,GAAG;EAClC,MAAME,GAAG,GAAGZ,WAAW,CAACW,MAAM,CAACC,GAAG;;EAElC;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA,MAAMC,GAAG,GACP,CAAC,gBAAgB,EAAE,CAAC,iBAAiB,CAAC;EAGxC,SAASC,eAAe,GAAG;IAAA;IACzB,MAAMC,GAAG,GAAG1B,MAAM,EAAE;IAEpBJ,SAAS,CAAC,MAAM;MACd,IAAIe,WAAW,CAACgB,MAAM,EAAED,GAAG,CAACE,KAAK,CAACjB,WAAW,CAACW,MAAM,EAAE,EAAE,CAAC;MACzD;MACA,MAAMO,MAAM,GAAGlB,WAAW,CAACmB,QAAQ;MACnC,MAAMC,MAAM,GAAG5B,CAAC,CAAC4B,MAAM,CAACpB,WAAW,CAACW,MAAM,EAAEO,MAAM,CAAC;MACnDE,MAAM,CAACC,KAAK,CAACN,GAAG,CAAC;IAEnB,CAAC,EAAE,CAACA,GAAG,CAAC,CAAC;IACT,OAAO,IAAI;EACb;EAAC,GAZQD,eAAe;IAAA,QACVzB,MAAM;EAAA;EAapBJ,SAAS,CAAC,MAAM;IACd,MAAMqC,GAAG,GAAG,IAAIC,cAAc,EAAE;IAEhC,MAAMC,KAAK,GAAG,qCAAqC;IACnDF,GAAG,CAACG,IAAI,CAAC,KAAK,EACX,iDAAgDD,KAAM,OAAM,GAC3Dd,GAAG,GAAG,OAAO,GAAGE,GAAG,GAAG,cAAc,EAAE,IAAI,CAAC;IAC/CU,GAAG,CAACI,IAAI,EAAE;IACVJ,GAAG,CAACK,kBAAkB,GAAGC,cAAc;IACvCN,GAAG,CAACO,gBAAgB,CAAC,kBAAkB,EAAED,cAAc,EAAE,KAAK,CAAC;IAE/D,SAASA,cAAc,CAACE,CAAC,EAAE;MACzB,IAAIR,GAAG,CAACS,UAAU,IAAI,CAAC,IAAIT,GAAG,CAACU,MAAM,IAAI,GAAG,EAAE;QAC5C,MAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAK,CAACb,GAAG,CAACc,YAAY,CAAC;QAC7C,MAAMC,IAAI,GAAGJ,QAAQ,CAACK,OAAO,CAACD,IAAI;QAClCtC,WAAW,CAACsC,IAAI,CAAC;MACnB;IACF;EACF,CAAC,EAAE,CAAC3B,GAAG,EAAEE,GAAG,CAAC,CAAC;EAGd3B,SAAS,CAAC,MAAM;IACd,MAAMsD,OAAO,GAAG;MACdC,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE,sCAAsC;MAC/CC,MAAM,EAAE;QACN,WAAW,EAAE,mCAAmC;QAChD,qBAAqB,EAAEpC,IAAI;QAC3B,wBAAwB,EAAEI,GAAG,GAAG,GAAG,GAAGE,GAAG;QACzC,wBAAwB,EAAE,KAAK;QAC/B,uBAAuB,EAAE,MAAM;QAC/B,YAAY,EAAEN,IAAI;QAClB,UAAU,EAAE;MACd,CAAC;MACDqC,OAAO,EAAE;QACPC,aAAa,EAAG,UAASzC,IAAK;MAChC;IACF,CAAC;IACD,IAAIH,WAAW,CAACgB,MAAM,EAAE9B,KAAK,CAAC2D,OAAO,CAACN,OAAO,CAAC,CAC3CO,IAAI,CAACC,GAAG,IAAI;MACXlD,QAAQ,CAACkD,GAAG,CAACC,IAAI,CAAC;MAClB/C,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAE6C,GAAG,CAACC,IAAI,CAAC;IAC9C,CAAC,CAAC,CACDC,KAAK,CAACC,GAAG,IAAI;MACZjD,OAAO,CAACkD,KAAK,CAACD,GAAG,CAACE,OAAO,CAAC;IAC5B,CAAC,CAAC;EACN,CAAC,EAAE,CAACpD,WAAW,EAAEM,IAAI,EAAEI,GAAG,EAAEE,GAAG,CAAC,CAAC;;EAGjC;EACA,MAAMyC,WAAW,GAAG,CAACzD,KAAK,CAAC0D,OAAO,IAAI,EAAE,EAAEvC,GAAG,CAACwC,IAAI,IAChDA,IAAI,CAACC,QAAQ,CAACzC,GAAG,CAAC0C,KAAK,iBAErB,QAAC,MAAM;IAEL,QAAQ,EAAE,CAACF,IAAI,CAACG,QAAQ,CAAC,CAAC,CAAC,EAAEH,IAAI,CAACG,QAAQ,CAAC,CAAC,CAAC,CAAE;IAAA,uBAC/C,QAAC,KAAK;MAAA,WACHH,IAAI,CAACI,KAAK,oBAAE;QAAA;QAAA;QAAA;MAAA,QAAM,OAAEF,KAAK,CAACG,IAAI;IAAA,GADrBH,KAAK,CAACI,SAAS;MAAA;MAAA;MAAA;IAAA;EAEnB,GAJHN,IAAI,CAACO,EAAE;IAAA;IAAA;IAAA;EAAA,QAMf,CACF,CAAC;EAEF7D,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEN,KAAK,CAAC;EAEtC,oBACE;IAAA,wBACE;MAAA,gBAAMI,WAAW,CAACgB,MAAM,GAAG,WAAW,GACpClB,QAAQ,GAAG,2BAA2B;IAAA;MAAA;MAAA;MAAA;IAAA,QACnC,eAEL,QAAC,YAAY;MACX,MAAM,EAAEe,GAAI;MACZ,IAAI,EAAE,CAAE;MAAC,eAAe,EAAE,IAAK;MAAA,WAE9BwC,WAAW,eAEZ,QAAC,SAAS;QACR,WAAW,EACX,yFAAyF;QACzF,GAAG,EAAC;MAAoD;QAAA;QAAA;QAAA;MAAA,QACxD,eACF,QAAC,eAAe;QAAA;QAAA;QAAA;MAAA,QAAG;IAAA;MAAA;MAAA;MAAA;IAAA,QACN;EAAA;IAAA;IAAA;IAAA;EAAA,QACX;AAEV;AAAC,IAvIuB3D,GAAG;EAAA,QAGLD,cAAc;AAAA;AAAA,KAHZC,GAAG;AAAA;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}